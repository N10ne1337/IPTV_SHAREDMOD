# –§–∞–π–ª: .github/workflows/sync.yml
# –≠—Ç–∞ –≤–µ—Ä—Å–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è, –µ–µ –º–æ–∂–Ω–æ –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å, –µ—Å–ª–∏ –æ–Ω–∞ —É–∂–µ —Ç–∞–∫–∞—è.

name: '–ê–≤—Ç–æ-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–ª–µ–π–ª–∏—Å—Ç–∞'

on:
  schedule:
    - cron: '0 */6 * * *'
  workflow_dispatch:

jobs:
  sync-playlist:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: '–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–¥–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è'
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: '–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python'
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: '–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π'
        run: |
          python -m pip install --upgrade pip
          pip install requests

      - name: '–ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–ª–µ–π–ª–∏—Å—Ç–∞'
        run: python update_playlist.py

      - name: '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π'
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: 'ü§ñ‚úÖ –ê–≤—Ç–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: –ø–ª–µ–π–ª–∏—Å—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω'
          # –í–∞–∂–Ω–æ: –∏–º—è —Ñ–∞–π–ª–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –≤–∞—à–∏–º
          file_pattern: 'IPTV_SHARED.m3u' 
          commit_user_name: 'GitHub Actions Bot'
          commit_user_email: 'actions@github.com'
          commit_author: 'GitHub Actions Bot <actions@github.com>'
