# –ò–º—è —Ñ–∞–π–ª–∞: .github/workflows/sync.yml
# –í–ï–†–°–ò–Ø 2.0 - –° –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï–ú –û–®–ò–ë–ö–ò [REJECTED]

name: '–ê–≤—Ç–æ-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–ª–µ–π–ª–∏—Å—Ç–∞'

on:
  schedule:
    - cron: '0 */6 * * *'
  workflow_dispatch:

jobs:
  sync-playlist:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      # –®–∞–≥ 1: –°–∫–∞—á–∏–≤–∞–µ–º –∫–æ–¥ –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.
      # –ú—ã –¥–æ–±–∞–≤–ª—è–µ–º `fetch-depth: 0`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å–ª–∏—è–Ω–∏—è.
      - name: '–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–¥–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è'
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 # <-- –í–ê–ñ–ù–û–ï –î–û–ë–ê–í–õ–ï–ù–ò–ï

      # –®–∞–≥ 2: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Python
      - name: '–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python'
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      # –®–∞–≥ 3: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
      - name: '–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π'
        run: |
          python -m pip install --upgrade pip
          pip install requests

      # –®–∞–≥ 4: –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–∞—à –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
      - name: '–ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–ª–µ–π–ª–∏—Å—Ç–∞'
        run: python update_playlist.py

      # –®–∞–≥ 5: –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è (–¥–µ–ª–∞–µ–º –∫–æ–º–º–∏—Ç)
      # –≠—Ç–æ—Ç —ç–∫—à–µ–Ω —É–º–Ω—ã–π –∏ —Å–∞–º —Å–ø—Ä–∞–≤–∏—Ç—Å—è —Å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è–º–∏, –µ—Å–ª–∏ —É –Ω–µ–≥–æ –µ—Å—Ç—å –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è
      - name: '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π'
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: 'ü§ñ –ê–≤—Ç–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: –ø–ª–µ–π–ª–∏—Å—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω'
          file_pattern: 'IPTV_SHARED.m3u'
          commit_user_name: 'GitHub Actions Bot'
          commit_user_email: 'actions@github.com'
          commit_author: 'GitHub Actions Bot <actions@github.com>'
